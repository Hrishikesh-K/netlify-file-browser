<script>let keepAlive=()=>{keepAlive=()=>{};var a=location.href.substr(0,location.href.lastIndexOf("/"))+"/ping",b=setInterval(()=>{sw?sw.postMessage("ping"):fetch(a).then(a=>a.text(!a.ok&&clearInterval(b)))},1e4)},messages=[];window.onmessage=a=>messages.push(a);let sw=null,scope="";function registerWorker(){return navigator.serviceWorker.getRegistration("./").then(a=>a||navigator.serviceWorker.register("sw.js",{scope:"./"})).then(a=>{let b=a.installing||a.waiting;return scope=a.scope,(sw=a.active)||new Promise(c=>{b.addEventListener("statechange",fn=()=>{"activated"===b.state&&(b.removeEventListener("statechange",fn),sw=a.active,c())})})})}function onMessage(e){let{data:a,ports:b,origin:c}=e;if(!b||!b.length)throw new TypeError("[StreamSaver] You didn't send a messageChannel");if("object"!=typeof a)throw new TypeError("[StreamSaver] You didn't send a object");a.origin=c,a.referrer=a.referrer||document.referrer||c,a.streamSaverVersion=new URLSearchParams(location.search).get("version"),"1.2.0"===a.streamSaverVersion&&console.warn("[StreamSaver] please update streamsaver"),a.headers?new Headers(a.headers):console.warn("[StreamSaver] pass `data.headers` that you would like to pass along to the service worker\nit should be a 2D array or a key/val object that fetch's Headers api accepts"),"string"==typeof a.filename&&(console.warn("[StreamSaver] You shouldn't send `data.filename` anymore. It should be included in the Content-Disposition header option"),a.filename=a.filename.replace(/\//g,":")),a.size&&console.warn("[StreamSaver] You shouldn't send `data.size` anymore. It should be included in the content-length header option"),a.readableStream&&console.warn("[StreamSaver] You should send the readableStream in the messageChannel, not throught mitm"),a.pathname||(console.warn("[StreamSaver] Please send `data.pathname` (eg: /pictures/summer.jpg)"),a.pathname=Math.random().toString().slice(-6)+"/"+a.filename),a.pathname=a.pathname.replace(/^\/+/g,"");let d=c.replace(/(^\w+:|^)\/\//,"");if(a.url=new URL(`${scope+d}/${a.pathname}`).toString(),!a.url.startsWith(`${scope+d}/`))throw new TypeError("[StreamSaver] bad `data.pathname`");let f=a.readableStream?[b[0],a.readableStream]:[b[0]];return a.readableStream||a.transferringReadable||keepAlive(),sw.postMessage(a,f)}window.opener&&window.opener.postMessage("StreamSaver::loadedPopup","*"),navigator.serviceWorker?registerWorker().then(()=>{window.onmessage=onMessage,messages.forEach(window.onmessage)}):keepAlive()</script>